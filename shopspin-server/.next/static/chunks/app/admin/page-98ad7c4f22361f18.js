(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{627:(e,t,r)=>{Promise.resolve().then(r.bind(r,7220))},7220:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),i=r(2115);function d(){var e;let[t,r]=(0,i.useState)([]),[d,o]=(0,i.useState)([]),[n,l]=(0,i.useState)(null),[a,c]=(0,i.useState)(new Map),[p,x]=(0,i.useState)(!0),[h,g]=(0,i.useState)(null),[u,f]=(0,i.useState)("wins"),[b,y]=(0,i.useState)(!1),[j,m]=(0,i.useState)(!0);(0,i.useEffect)(()=>{v()},[]),(0,i.useEffect)(()=>{if(b){S();let e=setInterval(S,3e4);return()=>clearInterval(e)}},[b]);let v=async()=>{try{let e=await fetch("/api/auth/check"),t=await e.json();y(t.authenticated)}catch(e){console.error("Auth check failed:",e),y(!1)}finally{m(!1)}},w=async e=>{try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e})});(await t.json()).success?y(!0):alert("Invalid password")}catch(e){console.error("Login failed:",e),alert("Login failed")}},S=async()=>{try{let[e,t,s]=await Promise.all([fetch("/api/wins"),fetch("/api/bets"),fetch("/api/stats")]),i=await e.json(),d=await t.json(),n=await s.json();i.success&&r(i.data),d.success&&o(d.data);let a=new Set;i.success&&i.data.forEach(e=>a.add(e.userId)),d.success&&d.data.forEach(e=>a.add(e.userId));let p=new Map;for(let e of a)try{let t=await fetch("/api/users?id=".concat(e)),r=await t.json();r.success&&r.data&&p.set(e,r.data)}catch(t){console.error("Error fetching user ".concat(e,":"),t)}c(p),n.success&&l(n.data)}catch(e){console.error("Error fetching data:",e)}finally{x(!1)}},k=async(e,t,r)=>{try{let s=await fetch("/api/wins/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t,orderDetails:r})}),i=await s.json();i.success?(await S(),g(null)):alert("Error updating win status: "+i.error)}catch(e){console.error("Error updating win:",e),alert("Error updating win status")}},C=async()=>{if(confirm("Are you sure you want to clear all data? This action cannot be undone."))try{let e=await fetch("/api/reset",{method:"POST"}),t=await e.json();t.success?(await S(),alert("Dashboard cleared successfully")):alert("Error clearing dashboard: "+t.error)}catch(e){console.error("Error clearing dashboard:",e),alert("Error clearing dashboard")}},W=e=>{switch(e){case"pending":return"#f59e0b";case"processing":return"#3b82f6";case"ordered":return"#8b5cf6";case"shipped":return"#06b6d4";case"delivered":return"#10b981";case"cancelled":return"#ef4444";default:return"#6b7280"}};return j?(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,s.jsx)("div",{children:"Loading..."})}):b?p?(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,s.jsx)("div",{children:"Loading..."})}):(0,s.jsxs)("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[(0,s.jsx)("h1",{style:{marginBottom:"30px",color:"#1f2937"},children:"\uD83C\uDFB0 ShopSpin Admin Dashboard"}),n&&(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px",marginBottom:"30px"},children:[(0,s.jsxs)("div",{style:{background:"#f3f4f6",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#374151"},children:"Total Users"}),(0,s.jsx)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#1f2937"},children:n.totalUsers})]}),(0,s.jsxs)("div",{style:{background:"#fef3c7",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#92400e"},children:"Total Bets"}),(0,s.jsx)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#78350f"},children:n.totalBets}),(0,s.jsxs)("p",{style:{fontSize:"12px",margin:"5px 0 0 0",color:"#92400e",opacity:.8},children:[n.winningBets," wins, ",n.losingBets," losses"]})]}),(0,s.jsxs)("div",{style:{background:"#e0f2fe",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#0277bd"},children:"Win Rate"}),(0,s.jsxs)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#01579b"},children:[n.winRate,"%"]})]}),(0,s.jsxs)("div",{style:{background:"#fee2e2",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#991b1b"},children:"Pending Fulfillment"}),(0,s.jsx)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#7f1d1d"},children:n.pendingWins})]}),(0,s.jsxs)("div",{style:{background:"#dcfce7",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#166534"},children:"Delivered"}),(0,s.jsx)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#14532d"},children:n.deliveredWins})]}),(0,s.jsxs)("div",{style:{background:"#dbeafe",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#1e40af"},children:"Total Value Paid Out"}),(0,s.jsxs)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#1e3a8a"},children:["$",n.totalValuePaidOut.toFixed(2)]})]}),(0,s.jsxs)("div",{style:{background:"#e0e7ff",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#3730a3"},children:"Total Stakes Collected"}),(0,s.jsxs)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#312e81"},children:["$",n.totalStakesCollected.toFixed(2)]})]}),(0,s.jsxs)("div",{style:{background:n.profitLoss>=0?"#dcfce7":"#fee2e2",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:n.profitLoss>=0?"#166534":"#991b1b"},children:"Total P/L"}),(0,s.jsxs)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:n.profitLoss>=0?"#14532d":"#7f1d1d"},children:[n.profitLoss>=0?"+":"","$",n.profitLoss.toFixed(2)]}),(0,s.jsxs)("p",{style:{fontSize:"12px",margin:"5px 0 0 0",color:n.profitLoss>=0?"#166534":"#991b1b",opacity:.8},children:[n.profitLoss>=0?"Profit":"Loss"," (Stakes - Payouts)"]})]})]}),(0,s.jsxs)("div",{style:{background:"white",borderRadius:"8px",border:"1px solid #e5e7eb",overflow:"hidden"},children:[(0,s.jsxs)("div",{style:{padding:"20px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[(0,s.jsx)("h2",{style:{margin:0,color:"#1f2937"},children:"Activity"}),(0,s.jsxs)("select",{value:u,onChange:e=>f(e.target.value),style:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",backgroundColor:"white",color:"#374151",fontSize:"14px",cursor:"pointer"},children:[(0,s.jsx)("option",{value:"wins",children:"Recent Wins"}),(0,s.jsx)("option",{value:"all",children:"All Activity"})]})]}),(0,s.jsx)("button",{onClick:C,style:{padding:"8px 16px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"Clear Dashboard"})]}),("wins"===u?t:d).length>0?(0,s.jsx)("div",{style:{overflowX:"auto"},children:(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{backgroundColor:"#f9fafb"},children:[(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Date"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"User"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Product"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Value"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Stake"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"wins"===u?"Status":"Result"}),"wins"===u&&(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Actions"})]})}),(0,s.jsx)("tbody",{children:"wins"===u?t.map(e=>{let t=a.get(e.userId);return(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[(0,s.jsx)("td",{style:{padding:"12px"},children:new Date(e.winTimestamp).toLocaleDateString()}),(0,s.jsx)("td",{style:{padding:"12px"},children:t?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:"500"},children:t.name}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#6b7280"},children:t.email})]}):(0,s.jsx)("span",{style:{color:"#6b7280"},children:"Loading..."})}),(0,s.jsx)("td",{style:{padding:"12px"},children:(0,s.jsxs)("div",{style:{maxWidth:"200px"},children:[(0,s.jsx)("div",{style:{fontWeight:"500",marginBottom:"4px"},children:e.product.name}),(0,s.jsx)("a",{href:e.product.url,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"12px",color:"#3b82f6",textDecoration:"none"},children:"View Product →"})]})}),(0,s.jsxs)("td",{style:{padding:"12px",fontWeight:"500"},children:["$",e.product.price.toFixed(2)]}),(0,s.jsxs)("td",{style:{padding:"12px"},children:["$",e.stakeAmount.toFixed(2)]}),(0,s.jsx)("td",{style:{padding:"12px"},children:(0,s.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",backgroundColor:W(e.status)+"20",color:W(e.status),border:"1px solid ".concat(W(e.status),"40")},children:e.status.toUpperCase()})}),(0,s.jsx)("td",{style:{padding:"12px"},children:(0,s.jsx)("button",{onClick:()=>g(e),style:{padding:"6px 12px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Manage"})})]},e.id)}):d.map(e=>{let t=a.get(e.userId);return(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[(0,s.jsx)("td",{style:{padding:"12px"},children:new Date(e.betTimestamp).toLocaleDateString()}),(0,s.jsx)("td",{style:{padding:"12px"},children:t?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:"500"},children:t.name}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#6b7280"},children:t.email})]}):(0,s.jsx)("span",{style:{color:"#6b7280"},children:"Loading..."})}),(0,s.jsx)("td",{style:{padding:"12px"},children:(0,s.jsxs)("div",{style:{maxWidth:"200px"},children:[(0,s.jsx)("div",{style:{fontWeight:"500",marginBottom:"4px"},children:e.product.name}),(0,s.jsx)("a",{href:e.product.url,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"12px",color:"#3b82f6",textDecoration:"none"},children:"View Product →"})]})}),(0,s.jsxs)("td",{style:{padding:"12px",fontWeight:"500"},children:["$",e.product.price.toFixed(2)]}),(0,s.jsxs)("td",{style:{padding:"12px"},children:["$",e.stakeAmount.toFixed(2)]}),(0,s.jsxs)("td",{style:{padding:"12px"},children:[(0,s.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",backgroundColor:e.won?"#dcfce7":"#fee2e2",color:e.won?"#166534":"#991b1b",border:e.won?"1px solid #16653440":"1px solid #991b1b40"},children:e.won?"WON":"LOST"}),(0,s.jsxs)("div",{style:{fontSize:"10px",color:"#6b7280",marginTop:"2px"},children:[(100*e.probability).toFixed(1),"% chance"]})]})]},e.id)})})]})}):(0,s.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#6b7280"},children:"wins"===u?"No wins recorded yet. Waiting for users to win!":"No activity recorded yet."})]}),h&&(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,s.jsxs)("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"8px",width:"90%",maxWidth:"500px",maxHeight:"80vh",overflow:"auto"},children:[(0,s.jsx)("h3",{style:{marginTop:0,marginBottom:"20px"},children:"Manage Win"}),(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,s.jsx)("strong",{children:"Product:"})," ",h.product.name,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Value:"})," $",h.product.price.toFixed(2),(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"User:"})," ",null==(e=a.get(h.userId))?void 0:e.name,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Current Status:"})," ",h.status]}),(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500"},children:"Update Status:"}),(0,s.jsxs)("select",{onChange:e=>{let t=e.target.value;k(h.id,t)},style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px"},defaultValue:h.status,children:[(0,s.jsx)("option",{value:"pending",children:"Pending"}),(0,s.jsx)("option",{value:"processing",children:"Processing"}),(0,s.jsx)("option",{value:"ordered",children:"Ordered"}),(0,s.jsx)("option",{value:"shipped",children:"Shipped"}),(0,s.jsx)("option",{value:"delivered",children:"Delivered"}),(0,s.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),a.get(h.userId)&&(0,s.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#f9fafb",borderRadius:"4px"},children:[(0,s.jsx)("strong",{children:"Shipping Address:"}),(0,s.jsx)("br",{}),a.get(h.userId).address.street,(0,s.jsx)("br",{}),a.get(h.userId).address.city,", ",a.get(h.userId).address.state," ",a.get(h.userId).address.zipCode,(0,s.jsx)("br",{}),a.get(h.userId).address.country]}),(0,s.jsx)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:(0,s.jsx)("button",{onClick:()=>g(null),style:{padding:"10px 20px",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Close"})})]})})]}):(0,s.jsx)(()=>{let[e,t]=(0,i.useState)("");return(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#f3f4f6"},children:(0,s.jsxs)("div",{style:{background:"white",padding:"40px",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",width:"400px",maxWidth:"90%"},children:[(0,s.jsx)("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#1f2937"},children:"\uD83C\uDFB0 ShopSpin Admin"}),(0,s.jsxs)("form",{onSubmit:t=>{t.preventDefault(),w(e)},children:[(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#374151"},children:"Admin Password:"}),(0,s.jsx)("input",{type:"password",value:e,onChange:e=>t(e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"},placeholder:"Enter admin password",required:!0})]}),(0,s.jsx)("button",{type:"submit",style:{width:"100%",padding:"12px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"Login"})]})]})})},{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(627)),_N_E=e.O()}]);