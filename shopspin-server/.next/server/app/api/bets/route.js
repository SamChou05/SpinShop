"use strict";(()=>{var e={};e.id=954,e.ids=[954],e.modules={846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2739:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>y,routeModule:()=>m,serverHooks:()=>g,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>w});var s={};t.r(s),t.d(s,{GET:()=>l,POST:()=>d});var o=t(6559),n=t(8088),a=t(7719),i=t(2190),u=t(8994),p=t(9812),c=t(7178);async function d(e){try{let r=(0,c.Tf)(e);if(c.qp.isRateLimited(r)){let e=c.qp.getResetTime(r),t=Math.ceil((e-Date.now())/1e3/60);return i.NextResponse.json({success:!1,error:`Rate limit exceeded. Too many bets. Try again in ${t} minutes.`},{status:429})}let t=await e.json();console.log("\uD83C\uDFB0 SERVER: Bet recording request received"),console.log("\uD83C\uDFB0 SERVER: Bet data:",{userId:t.userId,productName:t.product.name,stake:t.stakeAmount,won:t.won,probability:t.probability});try{if(!t.userId||"string"!=typeof t.userId)throw new p.yI("User ID is required");if((0,p.gi)(t.product),(0,p.x5)(t.stakeAmount,t.product.price),(0,p.WJ)(t.probability),"boolean"!=typeof t.won)throw new p.yI("Won status must be a boolean")}catch(e){if(e instanceof p.yI)return i.NextResponse.json({success:!1,error:e.message},{status:400});throw e}let s=await u.P.getUserById(t.userId);if(!s)return i.NextResponse.json({success:!1,error:"User not found"},{status:404});let o=await u.P.createBet({userId:t.userId,product:t.product,stakeAmount:t.stakeAmount,probability:t.probability,won:t.won,betTimestamp:new Date}),n=t.won?"WIN":"LOSS";return console.log(`ðŸŽ° ${n} RECORDED! User: ${s.email}, Product: ${t.product.name}, Stake: $${t.stakeAmount}, Won: ${t.won}`),i.NextResponse.json({success:!0,data:o,message:"Bet recorded successfully"})}catch(e){return console.error("\uD83C\uDFB0 SERVER: Error recording bet:",e),i.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}async function l(){try{let e=await u.P.getAllBets();return i.NextResponse.json({success:!0,data:e})}catch(e){return console.error("\uD83C\uDFB0 SERVER: Error fetching bets:",e),i.NextResponse.json({success:!1,error:"Internal server error"},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/bets/route",pathname:"/api/bets",filename:"route",bundlePath:"app/api/bets/route"},resolvedPagePath:"/Users/samchou/Sweepstakes Google Extension/shopspin-server/src/app/api/bets/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:w,serverHooks:g}=m;function y(){return(0,a.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:w})}},3033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6330:e=>{e.exports=require("@prisma/client")},9294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[447,580,780],()=>t(2739));module.exports=s})();