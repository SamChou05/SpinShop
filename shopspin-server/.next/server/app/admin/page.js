(()=>{var e={};e.id=698,e.ids=[698],e.modules={757:(e,t,r)=>{Promise.resolve().then(r.bind(r,2454))},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1132:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/samchou/Sweepstakes Google Extension/shopspin-server/src/app/admin/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/samchou/Sweepstakes Google Extension/shopspin-server/src/app/admin/page.tsx","default")},2454:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(687),i=r(3210);function o(){let[e,t]=(0,i.useState)([]),[r,o]=(0,i.useState)([]),[n,d]=(0,i.useState)(null),[l,a]=(0,i.useState)(new Map),[p,c]=(0,i.useState)(!0),[x,h]=(0,i.useState)(null),[u,g]=(0,i.useState)("wins"),[b,f]=(0,i.useState)(!1),[m,y]=(0,i.useState)(!0),j=async e=>{try{let t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e})});(await t.json()).success?f(!0):alert("Invalid password")}catch(e){console.error("Login failed:",e),alert("Login failed")}},v=async()=>{try{let[e,r,s]=await Promise.all([fetch("/api/wins"),fetch("/api/bets"),fetch("/api/stats")]),i=await e.json(),n=await r.json(),l=await s.json();i.success&&t(i.data),n.success&&o(n.data);let p=new Set;i.success&&i.data.forEach(e=>p.add(e.userId)),n.success&&n.data.forEach(e=>p.add(e.userId));let c=new Map;for(let e of p)try{let t=await fetch(`/api/users?id=${e}`),r=await t.json();r.success&&r.data&&c.set(e,r.data)}catch(t){console.error(`Error fetching user ${e}:`,t)}a(c),l.success&&d(l.data)}catch(e){console.error("Error fetching data:",e)}finally{c(!1)}},w=async(e,t,r)=>{try{let s=await fetch(`/api/wins/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t,orderDetails:r})}),i=await s.json();i.success?(await v(),h(null)):alert("Error updating win status: "+i.error)}catch(e){console.error("Error updating win:",e),alert("Error updating win status")}},S=async()=>{if(confirm("Are you sure you want to clear all data? This action cannot be undone."))try{let e=await fetch("/api/reset",{method:"POST"}),t=await e.json();t.success?(await v(),alert("Dashboard cleared successfully")):alert("Error clearing dashboard: "+t.error)}catch(e){console.error("Error clearing dashboard:",e),alert("Error clearing dashboard")}},k=e=>{switch(e){case"pending":return"#f59e0b";case"processing":return"#3b82f6";case"ordered":return"#8b5cf6";case"shipped":return"#06b6d4";case"delivered":return"#10b981";case"cancelled":return"#ef4444";default:return"#6b7280"}};return m?(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,s.jsx)("div",{children:"Loading..."})}):b?p?(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,s.jsx)("div",{children:"Loading..."})}):(0,s.jsxs)("div",{style:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},children:[(0,s.jsx)("h1",{style:{marginBottom:"30px",color:"#1f2937"},children:"\uD83C\uDFB0 ShopSpin Admin Dashboard"}),n&&(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px",marginBottom:"30px"},children:[(0,s.jsxs)("div",{style:{background:"#f3f4f6",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#374151"},children:"Total Users"}),(0,s.jsx)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#1f2937"},children:n.totalUsers})]}),(0,s.jsxs)("div",{style:{background:"#fef3c7",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#92400e"},children:"Total Bets"}),(0,s.jsx)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#78350f"},children:n.totalBets}),(0,s.jsxs)("p",{style:{fontSize:"12px",margin:"5px 0 0 0",color:"#92400e",opacity:.8},children:[n.winningBets," wins, ",n.losingBets," losses"]})]}),(0,s.jsxs)("div",{style:{background:"#e0f2fe",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#0277bd"},children:"Win Rate"}),(0,s.jsxs)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#01579b"},children:[n.winRate,"%"]})]}),(0,s.jsxs)("div",{style:{background:"#fee2e2",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#991b1b"},children:"Pending Fulfillment"}),(0,s.jsx)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#7f1d1d"},children:n.pendingWins})]}),(0,s.jsxs)("div",{style:{background:"#dcfce7",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#166534"},children:"Delivered"}),(0,s.jsx)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#14532d"},children:n.deliveredWins})]}),(0,s.jsxs)("div",{style:{background:"#dbeafe",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#1e40af"},children:"Total Value Paid Out"}),(0,s.jsxs)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#1e3a8a"},children:["$",n.totalValuePaidOut.toFixed(2)]})]}),(0,s.jsxs)("div",{style:{background:"#e0e7ff",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#3730a3"},children:"Total Stakes Collected"}),(0,s.jsxs)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:"#312e81"},children:["$",n.totalStakesCollected.toFixed(2)]})]}),(0,s.jsxs)("div",{style:{background:n.profitLoss>=0?"#dcfce7":"#fee2e2",padding:"20px",borderRadius:"8px"},children:[(0,s.jsx)("h3",{style:{margin:"0 0 10px 0",color:n.profitLoss>=0?"#166534":"#991b1b"},children:"Total P/L"}),(0,s.jsxs)("p",{style:{fontSize:"24px",fontWeight:"bold",margin:0,color:n.profitLoss>=0?"#14532d":"#7f1d1d"},children:[n.profitLoss>=0?"+":"","$",n.profitLoss.toFixed(2)]}),(0,s.jsxs)("p",{style:{fontSize:"12px",margin:"5px 0 0 0",color:n.profitLoss>=0?"#166534":"#991b1b",opacity:.8},children:[n.profitLoss>=0?"Profit":"Loss"," (Stakes - Payouts)"]})]})]}),(0,s.jsxs)("div",{style:{background:"white",borderRadius:"8px",border:"1px solid #e5e7eb",overflow:"hidden"},children:[(0,s.jsxs)("div",{style:{padding:"20px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[(0,s.jsx)("h2",{style:{margin:0,color:"#1f2937"},children:"Activity"}),(0,s.jsxs)("select",{value:u,onChange:e=>g(e.target.value),style:{padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",backgroundColor:"white",color:"#374151",fontSize:"14px",cursor:"pointer"},children:[(0,s.jsx)("option",{value:"wins",children:"Recent Wins"}),(0,s.jsx)("option",{value:"all",children:"All Activity"})]})]}),(0,s.jsx)("button",{onClick:S,style:{padding:"8px 16px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"Clear Dashboard"})]}),("wins"===u?e:r).length>0?(0,s.jsx)("div",{style:{overflowX:"auto"},children:(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{backgroundColor:"#f9fafb"},children:[(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Date"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"User"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Product"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Value"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Stake"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"wins"===u?"Status":"Result"}),"wins"===u&&(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"Actions"})]})}),(0,s.jsx)("tbody",{children:"wins"===u?e.map(e=>{let t=l.get(e.userId);return(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[(0,s.jsx)("td",{style:{padding:"12px"},children:new Date(e.winTimestamp).toLocaleDateString()}),(0,s.jsx)("td",{style:{padding:"12px"},children:t?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:"500"},children:t.name}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#6b7280"},children:t.email})]}):(0,s.jsx)("span",{style:{color:"#6b7280"},children:"Loading..."})}),(0,s.jsx)("td",{style:{padding:"12px"},children:(0,s.jsxs)("div",{style:{maxWidth:"200px"},children:[(0,s.jsx)("div",{style:{fontWeight:"500",marginBottom:"4px"},children:e.product.name}),(0,s.jsx)("a",{href:e.product.url,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"12px",color:"#3b82f6",textDecoration:"none"},children:"View Product â†’"})]})}),(0,s.jsxs)("td",{style:{padding:"12px",fontWeight:"500"},children:["$",e.product.price.toFixed(2)]}),(0,s.jsxs)("td",{style:{padding:"12px"},children:["$",e.stakeAmount.toFixed(2)]}),(0,s.jsx)("td",{style:{padding:"12px"},children:(0,s.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",backgroundColor:k(e.status)+"20",color:k(e.status),border:`1px solid ${k(e.status)}40`},children:e.status.toUpperCase()})}),(0,s.jsx)("td",{style:{padding:"12px"},children:(0,s.jsx)("button",{onClick:()=>h(e),style:{padding:"6px 12px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Manage"})})]},e.id)}):r.map(e=>{let t=l.get(e.userId);return(0,s.jsxs)("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[(0,s.jsx)("td",{style:{padding:"12px"},children:new Date(e.betTimestamp).toLocaleDateString()}),(0,s.jsx)("td",{style:{padding:"12px"},children:t?(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:{fontWeight:"500"},children:t.name}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"#6b7280"},children:t.email})]}):(0,s.jsx)("span",{style:{color:"#6b7280"},children:"Loading..."})}),(0,s.jsx)("td",{style:{padding:"12px"},children:(0,s.jsxs)("div",{style:{maxWidth:"200px"},children:[(0,s.jsx)("div",{style:{fontWeight:"500",marginBottom:"4px"},children:e.product.name}),(0,s.jsx)("a",{href:e.product.url,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"12px",color:"#3b82f6",textDecoration:"none"},children:"View Product â†’"})]})}),(0,s.jsxs)("td",{style:{padding:"12px",fontWeight:"500"},children:["$",e.product.price.toFixed(2)]}),(0,s.jsxs)("td",{style:{padding:"12px"},children:["$",e.stakeAmount.toFixed(2)]}),(0,s.jsxs)("td",{style:{padding:"12px"},children:[(0,s.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",backgroundColor:e.won?"#dcfce7":"#fee2e2",color:e.won?"#166534":"#991b1b",border:e.won?"1px solid #16653440":"1px solid #991b1b40"},children:e.won?"WON":"LOST"}),(0,s.jsxs)("div",{style:{fontSize:"10px",color:"#6b7280",marginTop:"2px"},children:[(100*e.probability).toFixed(1),"% chance"]})]})]},e.id)})})]})}):(0,s.jsx)("div",{style:{padding:"40px",textAlign:"center",color:"#6b7280"},children:"wins"===u?"No wins recorded yet. Waiting for users to win!":"No activity recorded yet."})]}),x&&(0,s.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,s.jsxs)("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"8px",width:"90%",maxWidth:"500px",maxHeight:"80vh",overflow:"auto"},children:[(0,s.jsx)("h3",{style:{marginTop:0,marginBottom:"20px"},children:"Manage Win"}),(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,s.jsx)("strong",{children:"Product:"})," ",x.product.name,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Value:"})," $",x.product.price.toFixed(2),(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"User:"})," ",l.get(x.userId)?.name,(0,s.jsx)("br",{}),(0,s.jsx)("strong",{children:"Current Status:"})," ",x.status]}),(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500"},children:"Update Status:"}),(0,s.jsxs)("select",{onChange:e=>{let t=e.target.value;w(x.id,t)},style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px"},defaultValue:x.status,children:[(0,s.jsx)("option",{value:"pending",children:"Pending"}),(0,s.jsx)("option",{value:"processing",children:"Processing"}),(0,s.jsx)("option",{value:"ordered",children:"Ordered"}),(0,s.jsx)("option",{value:"shipped",children:"Shipped"}),(0,s.jsx)("option",{value:"delivered",children:"Delivered"}),(0,s.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),l.get(x.userId)&&(0,s.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#f9fafb",borderRadius:"4px"},children:[(0,s.jsx)("strong",{children:"Shipping Address:"}),(0,s.jsx)("br",{}),l.get(x.userId).address.street,(0,s.jsx)("br",{}),l.get(x.userId).address.city,", ",l.get(x.userId).address.state," ",l.get(x.userId).address.zipCode,(0,s.jsx)("br",{}),l.get(x.userId).address.country]}),(0,s.jsx)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:(0,s.jsx)("button",{onClick:()=>h(null),style:{padding:"10px 20px",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Close"})})]})})]}):(0,s.jsx)(()=>{let[e,t]=(0,i.useState)("");return(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:"#f3f4f6"},children:(0,s.jsxs)("div",{style:{background:"white",padding:"40px",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",width:"400px",maxWidth:"90%"},children:[(0,s.jsx)("h1",{style:{textAlign:"center",marginBottom:"30px",color:"#1f2937"},children:"\uD83C\uDFB0 ShopSpin Admin"}),(0,s.jsxs)("form",{onSubmit:t=>{t.preventDefault(),j(e)},children:[(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,s.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#374151"},children:"Admin Password:"}),(0,s.jsx)("input",{type:"password",value:e,onChange:e=>t(e.target.value),style:{width:"100%",padding:"12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px"},placeholder:"Enter admin password",required:!0})]}),(0,s.jsx)("button",{type:"submit",style:{width:"100%",padding:"12px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"Login"})]})]})})},{})}},2980:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6346,23)),Promise.resolve().then(r.t.bind(r,7924,23)),Promise.resolve().then(r.t.bind(r,5656,23)),Promise.resolve().then(r.t.bind(r,99,23)),Promise.resolve().then(r.t.bind(r,8243,23)),Promise.resolve().then(r.t.bind(r,8827,23)),Promise.resolve().then(r.t.bind(r,2763,23)),Promise.resolve().then(r.t.bind(r,7173,23))},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4160:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>c,pages:()=>p,routeModule:()=>x,tree:()=>a});var s=r(5239),i=r(8088),o=r(8170),n=r.n(o),d=r(893),l={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);r.d(t,l);let a={children:["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1132)),"/Users/samchou/Sweepstakes Google Extension/shopspin-server/src/app/admin/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,4431)),"/Users/samchou/Sweepstakes Google Extension/shopspin-server/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,p=["/Users/samchou/Sweepstakes Google Extension/shopspin-server/src/app/admin/page.tsx"],c={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:a}})},4431:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>i});var s=r(7413);let i={title:"ShopSpin Admin Dashboard",description:"Administrative dashboard for managing ShopSpin wins and orders"};function o({children:e}){return(0,s.jsx)("html",{lang:"en",children:(0,s.jsx)("body",{style:{margin:0,fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:e})})}},6487:()=>{},7605:(e,t,r)=>{Promise.resolve().then(r.bind(r,1132))},8335:()=>{},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9828:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6444,23)),Promise.resolve().then(r.t.bind(r,6042,23)),Promise.resolve().then(r.t.bind(r,8170,23)),Promise.resolve().then(r.t.bind(r,9477,23)),Promise.resolve().then(r.t.bind(r,9345,23)),Promise.resolve().then(r.t.bind(r,2089,23)),Promise.resolve().then(r.t.bind(r,6577,23)),Promise.resolve().then(r.t.bind(r,1307,23))}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,825],()=>r(4160));module.exports=s})();