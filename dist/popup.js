var g=Object.defineProperty;var u=(r,t,n)=>t in r?g(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n;var d=(r,t,n)=>u(r,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(e){if(e.ep)return;e.ep=!0;const s=n(e);fetch(e.href,s)}})();class y{constructor(){d(this,"settings",{extensionEnabled:!0,soundEnabled:!1,animationsEnabled:!0});this.init()}async init(){await this.loadSettings(),await this.loadStats(),await this.loadHistory(),this.setupEventListeners()}async loadSettings(){const t=await chrome.storage.sync.get(["extensionEnabled","soundEnabled","animationsEnabled","stripePublishableKey","stripeSecretKey"]);this.settings={extensionEnabled:t.extensionEnabled!==!1,soundEnabled:t.soundEnabled||!1,animationsEnabled:t.animationsEnabled!==!1,stripePublishableKey:t.stripePublishableKey||"",stripeSecretKey:t.stripeSecretKey||""},this.updateUI()}updateUI(){this.setToggleState("extension-toggle",this.settings.extensionEnabled),this.setToggleState("sound-toggle",this.settings.soundEnabled),this.setToggleState("animation-toggle",this.settings.animationsEnabled);const t=document.getElementById("stripe-publishable"),n=document.getElementById("stripe-secret");t&&(t.value=this.settings.stripePublishableKey||""),n&&(n.value=this.settings.stripeSecretKey||"")}setToggleState(t,n){const i=document.getElementById(t);i&&(n?i.classList.add("active"):i.classList.remove("active"))}async loadStats(){const n=(await chrome.storage.local.get(["spinHistory"])).spinHistory||[],i=n.length,e=n.filter(l=>l.won).length,s=n.reduce((l,a)=>l+a.savings,0),o=i>0?e/i*100:0;document.getElementById("total-spins").textContent=i.toString(),document.getElementById("total-wins").textContent=e.toString(),document.getElementById("total-savings").textContent=`$${s.toFixed(2)}`,document.getElementById("win-rate").textContent=`${o.toFixed(1)}%`}async loadHistory(){const n=(await chrome.storage.local.get(["spinHistory"])).spinHistory||[],i=document.getElementById("spin-history");if(n.length===0){i.innerHTML=`
        <div style="text-align: center; opacity: 0.7; font-size: 14px;">
          No spins yet. Find a product to get started!
        </div>
      `;return}const e=n.slice(-5).reverse();i.innerHTML=e.map(s=>{const o=new Date(s.timestamp).toLocaleDateString(),l=s.won?"win":"loss",a=s.won?"WON":"LOST";return`
        <div class="history-item">
          <div>
            <div style="font-weight: bold;">${s.product.name.substring(0,30)}${s.product.name.length>30?"...":""}</div>
            <div style="opacity: 0.7;">${o} â€¢ $${s.stake.toFixed(2)} stake</div>
          </div>
          <div class="${l}" style="font-weight: bold;">${a}</div>
        </div>
      `}).join("")}setupEventListeners(){var t,n,i,e,s;(t=document.getElementById("extension-toggle"))==null||t.addEventListener("click",()=>{this.settings.extensionEnabled=!this.settings.extensionEnabled,this.saveSettings()}),(n=document.getElementById("sound-toggle"))==null||n.addEventListener("click",()=>{this.settings.soundEnabled=!this.settings.soundEnabled,this.saveSettings()}),(i=document.getElementById("animation-toggle"))==null||i.addEventListener("click",()=>{this.settings.animationsEnabled=!this.settings.animationsEnabled,this.saveSettings()}),(e=document.getElementById("save-stripe"))==null||e.addEventListener("click",()=>{const o=document.getElementById("stripe-publishable"),l=document.getElementById("stripe-secret");this.settings.stripePublishableKey=o.value,this.settings.stripeSecretKey=l.value,this.saveSettings();const a=document.getElementById("save-stripe"),c=a.textContent;a.textContent="Saved!",a.style.background="#10b981",setTimeout(()=>{a.textContent=c,a.style.background=""},2e3)}),(s=document.getElementById("clear-history"))==null||s.addEventListener("click",async()=>{confirm("Are you sure you want to clear your spin history?")&&(await chrome.storage.local.remove(["spinHistory"]),await this.loadStats(),await this.loadHistory())})}async saveSettings(){await chrome.storage.sync.set(this.settings),this.updateUI()}}document.addEventListener("DOMContentLoaded",()=>{new y});
