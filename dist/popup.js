var g=Object.defineProperty;var u=(l,t,e)=>t in l?g(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e;var r=(l,t,e)=>u(l,typeof t!="symbol"?t+"":t,e);class y{constructor(){r(this,"settings",{extensionEnabled:!0,soundEnabled:!1,animationsEnabled:!0});this.init()}async init(){await this.loadSettings(),await this.loadStats(),await this.loadHistory(),this.setupEventListeners()}async loadSettings(){const t=await chrome.storage.sync.get(["extensionEnabled","soundEnabled","animationsEnabled","stripePublishableKey","stripeSecretKey"]);this.settings={extensionEnabled:t.extensionEnabled!==!1,soundEnabled:t.soundEnabled||!1,animationsEnabled:t.animationsEnabled!==!1,stripePublishableKey:t.stripePublishableKey||"",stripeSecretKey:t.stripeSecretKey||""},this.updateUI()}updateUI(){this.setToggleState("extension-toggle",this.settings.extensionEnabled),this.setToggleState("sound-toggle",this.settings.soundEnabled),this.setToggleState("animation-toggle",this.settings.animationsEnabled);const t=document.getElementById("stripe-publishable"),e=document.getElementById("stripe-secret");t&&(t.value=this.settings.stripePublishableKey||""),e&&(e.value=this.settings.stripeSecretKey||"")}setToggleState(t,e){const s=document.getElementById(t);s&&(e?s.classList.add("active"):s.classList.remove("active"))}async loadStats(){const e=(await chrome.storage.local.get(["spinHistory"])).spinHistory||[],s=e.length,o=e.filter(a=>a.won).length,n=e.reduce((a,i)=>a+i.savings,0),d=s>0?o/s*100:0;document.getElementById("total-spins").textContent=s.toString(),document.getElementById("total-wins").textContent=o.toString(),document.getElementById("total-savings").textContent=`$${n.toFixed(2)}`,document.getElementById("win-rate").textContent=`${d.toFixed(1)}%`}async loadHistory(){const e=(await chrome.storage.local.get(["spinHistory"])).spinHistory||[],s=document.getElementById("spin-history");if(e.length===0){s.innerHTML=`
        <div style="text-align: center; opacity: 0.7; font-size: 14px;">
          No spins yet. Find a product to get started!
        </div>
      `;return}const o=e.slice(-5).reverse();s.innerHTML=o.map(n=>{const d=new Date(n.timestamp).toLocaleDateString(),a=n.won?"win":"loss",i=n.won?"WON":"LOST";return`
        <div class="history-item">
          <div>
            <div style="font-weight: bold;">${n.product.name.substring(0,30)}${n.product.name.length>30?"...":""}</div>
            <div style="opacity: 0.7;">${d} â€¢ $${n.stake.toFixed(2)} stake</div>
          </div>
          <div class="${a}" style="font-weight: bold;">${i}</div>
        </div>
      `}).join("")}setupEventListeners(){var t,e,s,o,n;(t=document.getElementById("extension-toggle"))==null||t.addEventListener("click",()=>{this.settings.extensionEnabled=!this.settings.extensionEnabled,this.saveSettings()}),(e=document.getElementById("sound-toggle"))==null||e.addEventListener("click",()=>{this.settings.soundEnabled=!this.settings.soundEnabled,this.saveSettings()}),(s=document.getElementById("animation-toggle"))==null||s.addEventListener("click",()=>{this.settings.animationsEnabled=!this.settings.animationsEnabled,this.saveSettings()}),(o=document.getElementById("save-stripe"))==null||o.addEventListener("click",()=>{const d=document.getElementById("stripe-publishable"),a=document.getElementById("stripe-secret");this.settings.stripePublishableKey=d.value,this.settings.stripeSecretKey=a.value,this.saveSettings();const i=document.getElementById("save-stripe"),c=i.textContent;i.textContent="Saved!",i.style.background="#10b981",setTimeout(()=>{i.textContent=c,i.style.background=""},2e3)}),(n=document.getElementById("clear-history"))==null||n.addEventListener("click",async()=>{confirm("Are you sure you want to clear your spin history?")&&(await chrome.storage.local.remove(["spinHistory"]),await this.loadStats(),await this.loadHistory())})}async saveSettings(){await chrome.storage.sync.set(this.settings),this.updateUI()}}document.addEventListener("DOMContentLoaded",()=>{new y});
